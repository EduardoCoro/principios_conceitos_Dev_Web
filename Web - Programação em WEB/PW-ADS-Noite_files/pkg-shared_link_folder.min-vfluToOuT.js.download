define("modules/clean/ajax_util",["require","exports","modules/clean/window_util"],function(e,t,n){"use strict";function r(e){return new Promise(function(t,r){function i(){return e().then(t)}var o=!1;n.onBeforeUnload(function(){o=!0}),i().catch(function(e){o?n.onPageRestore(function(){i().catch(r)}):r(e)})})}Object.defineProperty(t,"__esModule",{value:!0}),t.requestWithRetry=r}),define("modules/clean/photos/batching_thumb_store",["require","exports","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store","modules/constants/request"],function(e,t,n,r,i){"use strict";return function(e){var t=!(!e||!e.allow_http2)&&e.allow_http2,o=i.IS_HTTP2&&t,s=o?void 0:new n.BatchingThumbLoader;return new r.GenericThumbStore(s,!o)}}),define("modules/clean/photos/thumb_loading/batching_thumb_loader",["require","exports","modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(function(){function e(){this.batch_thumb_loader=new n.BatchThumbLoader({})}return e.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},e.prototype.load_image=function(e,t,n,r,i,o){this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:t,success:r,error:i,should_retry:o}),{onrequest:n,request_id:t}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},e.prototype._thumb_loaded=function(e,t){var n=e.url,i=(e.request_id,e.success),o=e.error,s=e.should_retry;t&&0===t.indexOf("data:")?i(t):r.load_individual_image(n,0,i,o,s)},e.prototype.cancel_thumb=function(e){this.batch_thumb_loader.cancel_thumb(e)},e})();t.BatchingThumbLoader=i}),define("modules/clean/prefetch/prefetch",["require","exports"],function(e,t){"use strict";function n(e){var t=window[e];if(t)return r(t)}function r(e){return new Promise(function(t,n){var r=e.getDataIfAvailable();r?r.payload?t(JSON.parse(r.payload)):n(r.error):e(function(e){return t(JSON.parse(e))},n)})}Object.defineProperty(t,"__esModule",{value:!0}),t.getPrefetchData=n}),define("modules/clean/react/icon/old_icons",["require","exports","tslib","external/react","external/spectrum/icon_content","external/spectrum/file_icon","modules/clean/react/icon/icon_helper"],function(e,t,n,r,i,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICON_SIZES=s.ICON_SIZES;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.alt,n=e.className,i=e.filename,a=e.size;return r.createElement(o.FileIcon,{alt:t,className:n,path:i,variant:s.to_spectrum_icon_size(a)})},t.defaultProps={size:s.ICON_SIZES.LARGE},t})(r.PureComponent);t.OldFileIcon=a,t.OldFolderIcon=function(e){var t=e.alt,n=e.className,o=e.size,a=e.isConfidential;return r.createElement(i.IconContent,{alt:t,className:n,name:s.spectrum_folder_icon({size:o,isConfidential:a})})},t.OldFolderIcon.defaultProps={size:s.ICON_SIZES.LARGE}}),define("modules/clean/react/shared_link_folder/actions",["require","exports","modules/clean/history","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/constants","modules/clean/react/shared_link_folder/dispatcher","modules/clean/react/shared_link_folder/utils","modules/core/browser","modules/core/i18n","modules/core/notify","modules/core/uri"],function(e,t,n,r,i,o,s,a,l,c,d){"use strict";function u(e){y("preview",e.filename)}function p(){w("preview")}function m(e){if(s.isNoAccessFolder(e))return void c.Notify.error(l._("Can’t open %(folder_name)s. Ask your admin for access.").format({folder_name:e.filename}));var t=d.URI.parse(e.href);"lst"in n.get_uri().getQuery()&&t.updateQuery({lst:""}),a.redirect(t.toString())}function h(){y("lst","")}function f(){w("lst")}function _(e,t){function n(e){o.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.FetchPageSuccess,data:e}),e.hasMoreEntries?r.fetchNextPage(t,e.nextRequestVoucher).then(n):o.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.LoadEnd})}o.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.LoadStart}),r.fetchFirstPage(t).then(n),o.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.InitializeCurrentFolder,data:{currentFolder:e}})}function g(){o.sharedLinkFolderDispatcher.dispatch({type:i.SharedLinkFolderAction.DismissOpenInAppBanner})}function k(e){n.push_state(e.getPath(),e.getQuery())}function y(e,t){var r={};r[e]=t;var i=n.get_uri();i.updateQuery(r),k(i)}function w(e){var t=n.get_uri();t.removeQuery(e),k(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.openFile=u,t.closeFile=p,t.openFolder=m,t.enableListMode=h,t.disableListMode=f,t.loadFolder=_,t.dismissOpenInAppBanner=g}),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/ajax_as_promised","modules/clean/ajax_util","modules/clean/prefetch/prefetch"],function(e,t,n,r,i){"use strict";function o(e){return{is_dir:e.is_dir,filename:e.filename,sort_key:e.sort_key,href:e.href,bytes:e.bytes,direct_blockserver_link:e.direct_blockserver_link,ns_id:e.ns_id,preview_type:e.preview_type?e.preview_type:null,preview_url:e.preview_url,sjid:e.sjid,ts:e.ts,thumbnail_url_tmpl:e.thumbnail_url_tmpl,beacon_context:e.beacon_context,file_id:e.file_id,video_container:e.video_container,video_transcode_url:e.video_transcode_url,video_metadata_url:e.video_metadata_url,preview_ssr_image_url_tmpl:e.preview_ssr_image_url_tmpl,preview_ssr_text_url_tmpl:e.preview_ssr_text_url_tmpl,preview_ssr_refresh_url:e.preview_ssr_refresh_url,htmlified_link:e.htmlified_link,linkfile_data:e.linkfile_data,revision_id:e.revision_id}}function s(e){return{_mount_access_perms:e._mount_access_perms,is_dir:e.is_dir,filename:e.filename,sort_key:e.sort_key,href:e.href,shared_folder_id:e.shared_folder_id,open_in_app_data:e.open_in_app_data}}function a(e){return{url:e.url,downloadTestUrl:e.downloadTestUrl,ownerName:e.ownerName,ownerTeamName:e.ownerTeamName,ownerTeamLogo:e.ownerTeamLogo}}function l(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles}}function c(e){return{displayName:e.displayName,isPackage:e.isPackage,itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath}}function d(e){for(var t=[],n=0,r=e.entries;n<r.length;n++){var i=r[n];i.is_dir?t.push(s(i)):t.push(o(i))}return{entries:t,sharedLinkInfos:e.shared_link_infos.map(a),sharePermissions:e.share_permissions.map(l),shareTokens:e.share_tokens.map(c),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,takedownRequestType:e.takedown_request_type}}function u(e,t){return new Promise(function(i){var o={};o.link_key=e.linkKey,o.link_type=e.linkType,o.secure_hash=e.secureHash,o.sub_path=e.subPath,t&&(o.voucher=t),r.requestWithRetry(function(){return n.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:o,dataType:"json"})}).then(function(e){i(d(e))})})}function p(){var e=i.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(d)}function m(e){return p()||u(e)}function h(e,t){return u(e,t)}Object.defineProperty(t,"__esModule",{value:!0}),t.fetchFirstPage=m,t.fetchNextPage=h}),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","external/react","external/lodash","modules/clean/react/async/loadable","modules/clean/open_in_app/actions","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/page","modules/clean/react/shared_link_folder/store","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/core/exception","modules/clean/web_timing_logger","external/react-redux","modules/clean/react/file_viewer/data/store","modules/clean/react/file_viewer/data/selectors","external/redux","modules/clean/react/file_viewer/data/actions","modules/constants/file_viewer","modules/core/browser","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial"],function(e,t,n,r,i,o,s,a,l,c,d,u,p,m,h,f,_,g,k,y,w,b,v,S,F,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=function(){return Promise.all([new Promise(function(t,n){e(["modules/clean/react/file_viewer/file_viewer"],t,n)}),new Promise(function(t,n){e(["modules/clean/react/file_viewer/actions"],t,n)})])},E=i.memoize(I),C=o.Loadable({loader:function(){return E().then(function(e){var t=e[0].FileViewer;e[1];return t})}}),T=(function(e){function t(t){var n=e.call(this,t)||this;n.onUpdateFromStore=function(){if(n.setState(n.getStateFromStore()),n.isViewingFile){var e=a.getFilenameFromLocation(n.props.location);setTimeout(function(){n.setupFileViewer(e)},0)}},n.onInterstitialClose=function(){n.props.onAppDownloadInterstitialDismissed()},n.onInterstitialContinue=function(){n.props.onAppDownloadInterstitialDismissed()};var r=m.Viewer.get_viewer(),i=r.work_user||r.personal_user;return n.state={files:[],fileSharePermissions:[],fileShareTokens:[],fileSharedLinkInfos:[],folders:[],isLoading:!1,showOpenInAppBanner:!1,user:i},n.hasAlreadyRendered=!1,n}return n.__extends(t,e),t.prototype.componentWillMount=function(){g.log_js_modules_application_code_start(),this.isViewingFile&&this.setupFileViewer(a.getFilenameFromLocation(this.props.location)),this.props.openImmediatelyInApp&&this.openImmediatelyInApp(),this.unsubscribe=p.sharedLinkFolderStore.addListener(this.onUpdateFromStore),d.loadFolder(this.props.folder,this.props.folderShareToken)},t.prototype.componentWillUnmount=function(){this.unsubscribe()},Object.defineProperty(t.prototype,"isViewingFile",{get:function(){return!!a.getFilenameFromLocation(this.props.location)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldForceListMode",{get:function(){return"lst"in this.props.location.query},enumerable:!0,configurable:!0}),t.prototype.getStateFromStore=function(){return{files:p.sharedLinkFolderStore.getFiles(),fileSharedLinkInfos:p.sharedLinkFolderStore.getFileSharedLinkInfos(),fileShareTokens:p.sharedLinkFolderStore.getFileShareTokens(),fileSharePermissions:p.sharedLinkFolderStore.getFileSharePermissions(),folders:p.sharedLinkFolderStore.getFolders(),isLoading:p.sharedLinkFolderStore.getIsLoading(),showOpenInAppBanner:p.sharedLinkFolderStore.showOpenInAppBanner(),takedownRequestType:p.sharedLinkFolderStore.getTakedownRequestType()}},t.prototype.openImmediatelyInApp=function(){try{this.props.folder.open_in_app_data&&s.openImmediately(this.props.folder.open_in_app_data)}catch(e){}},t.prototype.componentDidMount=function(){this.hasAlreadyRendered=!0,h.waitForTTI().then(function(){return E()})},t.prototype.componentWillUpdate=function(e){var t=a.getFilenameFromLocation(e.location);!this.isViewingFile&&t&&this.setupFileViewer(t)},t.prototype.setupFileViewer=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,o,s,a,l,c,d,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,E()];case 1:return t=n.sent(),r=t[1],c=i.find(this.state.files,function(t){return t.filename===e}),c?(o=this.state.files,s=this.state.fileSharePermissions,a=this.state.fileShareTokens,l=this.state.fileSharedLinkInfos,d=o.indexOf(c)):(_.assert(!!this.props.preview,"no preview data available"),u=this.props.preview,c=u.file,_.assert(c.filename===e,"preview data does not match desired file"),o=[c],s=[u.sharePermission],a=[u.shareToken],l=[u.sharedLinkInfo],d=0),r.setup(o,d,this.state.user,{sharedLinkInfos:l,shareTokens:a,sharePermissions:s}),[2]}})})},t.prototype.shouldShowAppDownloadInterstitial=function(){return!S.RESPONSIVE_SHARED_LINKS_SKIP_INTERSTITIAL&&F.is_mobile_or_tablet()&&this.props.folder.open_in_app_data&&!this.props.appDownloadInterstitialDismissed},t.prototype.render=function(){if(this.isViewingFile){var e=this.hasAlreadyRendered?c.PreviewSourceAction.Click:c.PreviewSourceAction.Visit;return r.createElement(C,{activityContext:this.props.activityContext,canClose:!0,className:"no-background",fileViewOrigin:this.props.fileViewOrigin,fileViewTarget:this.props.fileViewTarget,fileViewAction:f.FileViewActionType.CLICK,initialPreviewSourceContext:c.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:e,skipOuterRouting:!0,onCloseViewer:d.closeFile})}if(this.shouldShowAppDownloadInterstitial())return r.createElement("div",{"aria-label":this.props.folderShareToken.displayName},r.createElement(L.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:this.props.folderShareToken.displayName,open_in_app_data:this.props.folder.open_in_app_data,ownerName:this.props.folderSharedLinkInfo.ownerName,ownerTeamName:this.props.folderSharedLinkInfo.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue}));var t={files:this.state.files,folders:this.state.folders};return r.createElement(u.SharedLinkFolderPage,{accountMenuOptions:this.props.accountMenuOptions,folder:this.props.folder,folderSharedLinkInfo:this.props.folderSharedLinkInfo,folderShareToken:this.props.folderShareToken,folderSharePermission:this.props.folderSharePermission,isLoading:this.state.isLoading,contents:t,user:this.state.user,outOfQuota:this.props.outOfQuota,shouldForceListMode:this.shouldForceListMode,showSyncCoachmark:this.props.showSyncCoachmark,showOpenInAppBanner:this.state.showOpenInAppBanner,takedownRequestType:this.state.takedownRequestType})},t})(r.Component),N=l.withLocation(T),P=function(e){return b.bindActionCreators({onAppDownloadInterstitialDismissed:v.dismissAppDownloadInterstitial},e)},x=k.connect(function(e){return{appDownloadInterstitialDismissed:w.getAppDownloadInterstitial(e)}},P)(N),A=y.getStoreForFileViewer(),O=function(e){return r.createElement(k.Provider,{store:A},r.createElement(x,n.__assign({},e)))};t.SharedLinkFolderApp=O}),define("modules/clean/react/shared_link_folder/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.DismissOpenInAppBanner=0]="DismissOpenInAppBanner",e[e.FetchPageSuccess=1]="FetchPageSuccess",e[e.InitializeCurrentFolder=2]="InitializeCurrentFolder",e[e.LoadStart=3]="LoadStart",e[e.LoadEnd=4]="LoadEnd"})(t.SharedLinkFolderAction||(t.SharedLinkFolderAction={}))}),define("modules/clean/react/shared_link_folder/dispatcher",["require","exports","modules/clean/flux/dispatcher"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sharedLinkFolderDispatcher=n.Dispatcher}),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","external/react","modules/clean/react/shared_link_folder/utils","modules/clean/react/icon/icon_helper","modules/clean/react/icon/old_icons"],function(e,t,n,r,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SharedLinkFolderFolderIcon=function(e){var t=e.className,i=e.folder,s=e.size;return n.createElement(o.OldFolderIcon,{alt:i.filename,className:t,isConfidential:r.isNoAccessFolder(i),size:s})},t.SharedLinkFolderFolderIcon.defaultProps={size:i.ICON_SIZES.LARGE}}),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/old_icons","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/utils","modules/clean/react/thumbnail"],function(e,t,n,r,i,o,s,a,l,c,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.renderCell=function(e){var t=i.Emstring.em_snippet(e.filename,16);return e.is_dir?r.createElement(m,{folder:e,label:t}):r.createElement(p,{file:e,label:t})},t.prototype.render=function(){var e=this,t=this.props.entries.map(function(t){return r.createElement("li",{className:"sl-grid-cell",key:t.filename},e.renderCell(t))});return r.createElement("div",{className:"sl-grid"},r.createElement("div",{className:"sl-grid-header clearfix"},r.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},"Sorted by name")),r.createElement("ol",{className:"sl-grid-body clearfix"},t))},t})(r.Component);t.SharedLinkFolderGrid=u;var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=c.linkClickHandler(function(e){e.preventDefault(),a.openFile(t.props.file)}),t}return n.__extends(t,e),Object.defineProperty(t.prototype,"isVideo",{get:function(){return this.props.file.preview_type===o.PreviewType.Video},enumerable:!0,configurable:!0}),t.prototype.renderIconOrThumbnail=function(){var e;return this.isVideo&&(e=r.createElement("div",{className:"sl-video-watermark"})),r.createElement("span",null,r.createElement(d.ThumbnailIcon,{alt:this.props.file.filename,className:"sl-grid-thumbnail",file:this.props.file,iconSize:s.ICON_SIZES.XLARGE}),e)},t.prototype.render=function(){return r.createElement("a",{href:this.props.file.href,onClick:this.onClick,className:"sl-link sl-link--file",title:this.props.file.filename},r.createElement("div",{className:"sl-grid-thumbnail-container"},this.renderIconOrThumbnail()),r.createElement("div",{className:"sl-grid-filename"},this.props.label))},t})(r.Component);t.FileCell=p;var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=c.linkClickHandler(function(e){e.preventDefault(),a.openFolder(t.props.folder)}),t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.folder,n=e.label;return r.createElement("a",{href:t.href,onClick:this.onClick,className:"sl-link sl-link--folder",title:t.filename},r.createElement("div",{className:"sl-grid-thumbnail-container"},r.createElement(l.SharedLinkFolderFolderIcon,{className:"sl-grid-thumbnail",folder:t,size:s.ICON_SIZES.XLARGE})),r.createElement("div",{className:"sl-grid-filename"},n))},t})(r.PureComponent);t.FolderCell=m}),define("modules/clean/react/shared_link_folder/list",["require","exports","tslib","external/react","external/spectrum/table","external/spectrum/media_table","modules/clean/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/core/browser","modules/clean/react/size_class/constants"],function(e,t,n,r,i,o,s,a,l,c,d,u,p,m,h){"use strict";function f(e){var t=e.entry,n=e.sizeClass;return t.is_dir?r.createElement(k,{folder:t,sizeClass:n}):r.createElement(y,{file:t,sizeClass:n})}Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.entries,n=e.sizeClass;return r.createElement(i.Table,{className:"sl-list-container"},r.createElement(i.TableHead,null,r.createElement(i.TableHeadCell,null,u._("Name")),n!==h.SizeClass.Small?r.createElement(i.TableHeadCell,null,u._("Modified",{comment:"label for last modified time"})):null),r.createElement(i.TableBody,null,t.map(function(e){return r.createElement(f,{key:e.filename,entry:e,sizeClass:n})})))},t})(r.Component);t.SharedLinkFolderList=_;var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){var e=t.props,n=e.href,r=e.onClick;r?r():n&&m.redirect(t.props.href)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.icon,n=e.lastModified,i=e.name,l=e.sizeClass;return r.createElement(o.MediaRow,{onClick:this.onClick},r.createElement(o.MediaCell,{className:"sl-list-column--filename",icon:t,title:a.Emstring.em_snippet(i,40)}),l!==h.SizeClass.Small?r.createElement(o.MediaCell,{className:"sl-list-column--modified",title:n?s.format_date(n,s.localized_datetime_format):"--"}):null)},t})(r.Component),k=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return l.openFolder(t.props.folder)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.folder,n=e.sizeClass,i=p.URI.parse(t.href).updateQuery({lst:""}),o=i.toString();return r.createElement(g,{icon:r.createElement(c.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:t}),href:o,name:t.filename,onClick:this.onClick,sizeClass:n})},t})(r.Component),y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(){return l.openFile(t.props.file)},t}return n.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.file,n=e.sizeClass;return r.createElement(g,{icon:r.createElement(d.ThumbnailIcon,{alt:t.filename,className:"sl-list-icon",file:t}),lastModified:new Date(1e3*t.ts),name:t.filename,href:t.href,onClick:this.onClick,sizeClass:n})},t})(r.Component)}),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","external/classnames","external/react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/previews/responsive_utils","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/actions","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/takedown_warning","modules/clean/sharing/constants","modules/clean/web_timing_logger","modules/constants/trademark","modules/core/i18n","modules/core/uri","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants"],function(e,t,n,r,i,o,s,a,l,c,d,u,p,m,h,f,_,g,k,y,w,b,v,S,F,L,I){"use strict";function E(e,t){return a.compare(e.sort_key,t.sort_key,1)}function C(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),t.concat(e).sort(E)}function T(e){return i.createElement("div",{className:"sl-body sl-body--empty-folder"},i.createElement(h.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:F.ICON_SIZES.XLARGE}),i.createElement("h3",{className:"sl-empty-folder-message"},v._("This folder is empty")))}function N(e){var t=e.files,n=e.folder,r=e.isLoading,o=e.shouldForceListMode,s=e.sizeClass,a=e.subfolders,l=C(t,a);return l.length||r?i.createElement("div",{className:"sl-body"},o?[i.createElement(_.SharedLinkFolderList,{entries:l,sizeClass:s}),i.createElement(g.FolderViewToggleOption,{icon:"grid_light",label:v._("View as grid"),onClick:m.disableListMode})]:[i.createElement(f.SharedLinkFolderGrid,{entries:l}),i.createElement(g.FolderViewToggleOption,{icon:"list_light",label:v._("View as list"),onClick:m.enableListMode})]):i.createElement(T,{folder:n})}function P(e){var t=e.title,n=e.ownerName,r=e.ownerTeamName,o=e.ownerTeamLogo,s=e.sizeClass;return i.createElement("span",null,t,s===I.SizeClass.Small?i.createElement("br",null):null,i.createElement(x,{ownerName:n,ownerTeamName:r,ownerTeamLogo:o}))}function x(e){var t=e.ownerName,n=e.ownerTeamName,r=e.ownerTeamLogo;return n?i.createElement("div",{className:"sl-title-owner"},null!=t?v._("from %(owner)s (%(team)s)").format({owner:t,team:n}):v._("from %(team)s").format({team:n}),null!=r?i.createElement("span",null," ","via ",i.createElement("a",{href:M},b.TRADEMARK_BUSINESS)):null):null}Object.defineProperty(t,"__esModule",{value:!0});var A=c.Loadable({loader:function(){return new Promise(function(t,n){e(["modules/clean/react/shared_link_folder/title_bar"],t,n)}).then(function(e){return e.SharedLinkFolderTitleBar})}}),O=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming()},t.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},t.prototype.ensureWebTimingMarked=function(){var e=this.props.contents,t=e.files,n=e.folders,r=!this.props.isLoading,i=t.length>0||n.length>0;(r||i)&&(w.mark_time_to_view(),w.mark_time_to_interactive())},t.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===y.SharedLinkType.Content){var e=(new Date).getTime(),t={ns_id:this.props.folder.shared_folder_id,timing:e-w.start_time()};o.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",y.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,t)}},t.prototype.render=function(){var e=this.props,t=e.accountMenuOptions,n=e.contents,o=e.folder,a=e.folderSharedLinkInfo,l=e.folderSharePermission,c=e.folderShareToken,u=e.isLoading,h=e.outOfQuota,f=e.shouldForceListMode,_=e.showOpenInAppBanner,g=e.showSyncCoachmark,y=e.sizeClass,w=e.takedownRequestType,b=e.user,v=i.createElement(P,{sizeClass:y,title:d.Emstring.em_snippet(c.displayName,y!==I.SizeClass.Small?35:20),ownerName:a.ownerName,ownerTeamName:a.ownerTeamName,ownerTeamLogo:a.ownerTeamLogo}),S=r({"sl-page-body":!0,"view-in-app-bar-present":_});return i.createElement("div",{className:"sl-page-container"},i.createElement("div",{className:"sl-page-header"},i.createElement(A,{accountMenuOptions:t,folder:o,outOfQuota:h,sharedLinkInfo:a,shareToken:c,sharePermission:l,showSyncCoachmark:g,sizeClass:y,title:y===I.SizeClass.Small?v:void 0,user:b}),y!==I.SizeClass.Large&&_?i.createElement(p.OpenInAppBanner,{urls:o.open_in_app_data,onClose:m.dismissOpenInAppBanner}):null),i.createElement("div",{className:S},i.createElement("div",{className:"sl-header clearfix"},i.createElement("h3",{className:"sl-title"},null!=w?i.createElement("div",{className:"sl-takedown-warning"},i.createElement(k,{type:w})):null,y!==I.SizeClass.Small?v:null)),i.createElement(N,{files:n.files,folder:o,isLoading:u,shouldForceListMode:f,sizeClass:y,subfolders:n.folders}),u?i.createElement("div",{className:"sl-loading-indicator"},i.createElement(s.LoadingIndicator,{style:s.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null))},t.defaultProps={shouldForceListMode:!1},t})(i.Component);t._SharedLinkFolderPage=O;var R=l(O,["/static/css/react_title_bar-vflxAa9CC.css","/static/css/react_file_viewer-vflcsjmlw.css"]),D=L.withSizeClass(R,{isResponsiveEnabled:u.isResponsiveEnabled});t.SharedLinkFolderPage=D;var M=new S.URI({scheme:"https",authority:"www.dropbox.com",path:"/business",query:{src:"schmodel"}}).toString()}),define("modules/clean/react/shared_link_folder/store",["require","exports","tslib","modules/clean/flux/flux_store","modules/clean/react/shared_link_folder/constants","modules/clean/react/shared_link_folder/dispatcher"],function(e,t,n,r,i,o){"use strict";function s(e){return!e.is_dir}Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(t){var n=e.call(this,t)||this;return n.fileIds={},n.folderFilenames={},n.fileIds={},n.files=[],n.fileSharedLinkInfos=[],n.fileSharePermissions=[],n.fileShareTokens=[],n.folderFilenames={},n.folders=[],n.isLoading=!1,n.viewInAppBannerDismissed=!1,n}return n.__extends(t,e),t.prototype.getFolders=function(){return this.folders},t.prototype.getFiles=function(){return this.files},t.prototype.getFileSharePermissions=function(){return this.fileSharePermissions},t.prototype.getFileShareTokens=function(){return this.fileShareTokens},t.prototype.getFileSharedLinkInfos=function(){return this.fileSharedLinkInfos},t.prototype.getIsLoading=function(){return this.isLoading},t.prototype.getTakedownRequestType=function(){return this.takedownRequestType},t.prototype.showOpenInAppBanner=function(){return!this.viewInAppBannerDismissed&&!(!this.currentFolder||!this.currentFolder.open_in_app_data)},t.prototype.handleFetchPageSuccess=function(e){var t=this;e.entries.forEach(function(n,r){s(n)?n.file_id in t.fileIds||(t.fileIds[n.file_id]=!0,t.files.push(n),t.fileSharedLinkInfos.push(e.sharedLinkInfos[r]),t.fileSharePermissions.push(e.sharePermissions[r]),t.fileShareTokens.push(e.shareTokens[r])):n.filename in t.folderFilenames||(t.folderFilenames[n.filename]=!0,t.folders.push(n))}),!this.takedownRequestType&&e.takedownRequestType&&(this.takedownRequestType=e.takedownRequestType),this.__emitChange()},t.prototype.handleLoadStart=function(){this.isLoading=!0,this.__emitChange()},t.prototype.handleLoadEnd=function(){this.isLoading=!1,this.__emitChange()},t.prototype.handleDismissViewInAppBanner=function(){this.viewInAppBannerDismissed=!0,this.__emitChange()},t.prototype.initializeCurrentFolder=function(e){this.currentFolder=e.currentFolder,this.__emitChange()},t.prototype.__onDispatch=function(e){e.action.type===i.SharedLinkFolderAction.DismissOpenInAppBanner?this.handleDismissViewInAppBanner():e.action.type===i.SharedLinkFolderAction.FetchPageSuccess?this.handleFetchPageSuccess(e.action.data):e.action.type===i.SharedLinkFolderAction.InitializeCurrentFolder?this.initializeCurrentFolder(e.action.data):e.action.type===i.SharedLinkFolderAction.LoadStart?this.handleLoadStart():e.action.type===i.SharedLinkFolderAction.LoadEnd&&this.handleLoadEnd()},t})(r.FluxStore);t.sharedLinkFolderStore=new a(o.sharedLinkFolderDispatcher)}),define("modules/clean/react/shared_link_folder/utils",["require","exports"],function(e,t){"use strict";function n(e){return function(t){t.ctrlKey||t.metaKey||e(t)}}function r(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")}Object.defineProperty(t,"__esModule",{value:!0}),t.linkClickHandler=n,t.isNoAccessFolder=r}),define("modules/clean/react/shared_link_folder/view_toggle",["require","exports","external/classnames","external/react","modules/clean/react/sprite"],function(e,t,n,r,i){"use strict";function o(e){var t=e.icon,o=e.label,s=e.onClick;return r.createElement("button",{"aria-label":o,className:n({"sl-view-toggle-option":!0}),name:o,onClick:s,value:o},r.createElement(i.Sprite,{group:"web",name:t,alt:o}))}Object.defineProperty(t,"__esModule",{value:!0}),t.FolderViewToggleOption=o}),define("modules/clean/react/takedown_warning",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/react_format","modules/constants/python","modules/core/i18n"],function(e,t,n,r,i,o,s,a,l){"use strict";var c=i.a,d=i.div;return(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getWarningMessage=function(){switch(t.props.type){case a.TakedownRequestTypes.DMCA:return s.reactFormat(l._("Certain files in this folder can’t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"),{a:c({target:"_top",href:"/help/210"})});default:return s.reactFormat(l._("Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."),{a:c({target:"_top",href:"/ticket"})})}},t}return n.__extends(t,e),t.prototype.render=function(){return d({className:"notify server-success"},this._getWarningMessage())},t.displayName="TakedownWarning",t.propTypes={type:o.number},t})(r.Component)}),define("modules/clean/react/thumbnail",["require","exports","tslib","external/classnames","external/react","modules/clean/photos/batching_thumb_store","modules/clean/react/icon/old_icons","modules/constants/python","modules/core/uri","modules/clean/react/file_viewer/file_utils"],function(e,t,n,r,i,o,s,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=o(),u=(function(e){function t(t){var n=e.call(this,t)||this;return n.handleImageError=function(){n.setState({src:null})},n.state=n.getStateForTemplateUrl(n.props.file.thumbnail_url_tmpl),n}return n.__extends(t,e),t.prototype.componentDidMount=function(){this.bindThumbStore()},
t.prototype.componentWillReceiveProps=function(e){var t=e.file.thumbnail_url_tmpl;t!==this.props.file.thumbnail_url_tmpl&&this.setState(this.getStateForTemplateUrl(t))},t.prototype.componentWillUpdate=function(){this.unbindThumbStore()},t.prototype.componentDidUpdate=function(){this.bindThumbStore()},t.prototype.componentWillUnmount=function(){this.unbindThumbStore()},t.prototype.bindThumbStore=function(){var e=this;if(this.state.isLoading&&!this.bindingId){var t=this.state.url;t&&(this.bindingId=d.bind_url(t,{onSuccess:function(){e.setState({isLoading:!1,src:d.get_thumb(t)})},onError:function(){e.setState({isLoading:!1})}}))}},t.prototype.unbindThumbStore=function(){this.bindingId&&(d.unbind_url(this.bindingId),delete this.bindingId)},t.prototype.getStateForTemplateUrl=function(e){var n=null;if(!e)return{isLoading:!1,src:null};var r=t.getThumbnailUrl(e);return r&&(n=d.get_thumb(r)),{isLoading:!!r&&!n,src:n,url:r}},t.getThumbnailUrl=function(e){if(e){var t=l.URI.parse(e);return t.updateQuery("size","178x178"),t.updateQuery("size_mode",a.THUMBNAIL_SIZE_MODE.EXACT.toString()),t.toString()}},t.prototype.render=function(){var e,t=this.props,n=t.alt,o=t.file,a=t.iconSize,l=t.className,d=this.state.src;return d?(e=["icon","thumbnail-image--loaded",l],i.createElement("img",{alt:n,className:r(e),src:d,onError:this.handleImageError})):(e=["icon","thumbnail-image--failed",l],i.createElement(s.OldFileIcon,{alt:n,className:r(e),filename:c.getFilename(o),size:a}))},t.displayName="ThumbnailIcon",t})(i.Component);t.ThumbnailIcon=u});
//# sourceMappingURL=pkg-shared_link_folder.min.js-vfl-IlTBK.map